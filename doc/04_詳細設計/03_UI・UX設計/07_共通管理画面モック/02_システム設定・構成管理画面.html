<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>システム設定・構成管理 - SES業務システム</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
    
    <!-- カスタムCSS -->
    <style>
        :root {
            --sidebar-width: 280px;
            --header-height: 60px;
            --ses-primary: #0d6efd;
            --ses-secondary: #6c757d;
            --ses-success: #198754;
            --ses-warning: #ffc107;
            --ses-danger: #dc3545;
            --ses-light: #f8f9fa;
        }
        
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            min-height: calc(100vh - var(--header-height));
        }
        
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background-color: #212529;
            z-index: 1000;
        }
        
        .navbar {
            height: var(--header-height);
            background-color: #ffffff !important;
            border-bottom: 1px solid #dee2e6;
        }
        
        .setting-card {
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.2s ease;
        }
        
        .setting-card:hover {
            border-color: var(--ses-primary);
            box-shadow: 0 2px 8px rgba(13, 110, 253, 0.1);
        }
        
        .setting-card.modified {
            border-left: 4px solid var(--ses-warning);
            background-color: #fff9e6;
        }
        
        .config-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .status-active {
            background: #e8f5e8;
            border: 1px solid var(--ses-success);
            color: var(--ses-success);
        }
        
        .status-inactive {
            background: #f8f9fa;
            border: 1px solid var(--ses-secondary);
            color: var(--ses-secondary);
        }
        
        .status-error {
            background: #ffebee;
            border: 1px solid var(--ses-danger);
            color: var(--ses-danger);
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }
        
        .nav-tabs .nav-link.active {
            border-color: var(--ses-primary);
            color: var(--ses-primary);
        }
        
        .environment-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: bold;
        }
        
        .env-production {
            background: #dc3545;
            color: white;
        }
        
        .env-staging {
            background: #ffc107;
            color: #212529;
        }
        
        .env-development {
            background: #198754;
            color: white;
        }
        
        .system-health {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid #dee2e6;
        }
        
        .health-excellent {
            border-color: var(--ses-success);
            background: #e8f5e8;
        }
        
        .health-good {
            border-color: #28a745;
            background: #e8f5e8;
        }
        
        .health-warning {
            border-color: var(--ses-warning);
            background: #fff3e0;
        }
        
        .health-critical {
            border-color: var(--ses-danger);
            background: #ffebee;
        }
    </style>
</head>
<body x-data="systemSettings" x-cloak>
    
    <!-- ヘッダー -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container-fluid">
            <button class="btn btn-outline-secondary me-3" @click="toggleSidebar()">
                <i class="bi bi-list"></i>
            </button>
            <a class="navbar-brand" href="#">SES業務システム</a>
            <div class="navbar-nav ms-auto">
                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle me-1"></i>システム管理者
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>プロフィール</a></li>
                        <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>設定</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>ログアウト</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- サイドバー -->
    <nav class="sidebar text-white">
        <div class="p-3">
            <h6 class="text-light mb-3">管理機能</h6>
            <ul class="nav nav-pills flex-column">
                <li class="nav-item">
                    <a class="nav-link text-white-50" href="#">
                        <i class="bi bi-people me-2"></i>ユーザー管理
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white active" href="#">
                        <i class="bi bi-gear me-2"></i>システム設定
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white-50" href="#">
                        <i class="bi bi-database me-2"></i>マスターデータ
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white-50" href="#">
                        <i class="bi bi-file-text me-2"></i>監査ログ
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white-50" href="#">
                        <i class="bi bi-diagram-3 me-2"></i>外部連携
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    
    <!-- メインコンテンツ -->
    <main class="main-content">
        <div class="container-fluid p-4">
            
            <!-- ページヘッダー -->
            <div class="d-flex justify-content-between align-items-start mb-4">
                <div>
                    <h1 class="h3 mb-2">システム設定・構成管理</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb mb-0">
                            <li class="breadcrumb-item"><a href="#" class="text-decoration-none">管理画面</a></li>
                            <li class="breadcrumb-item active">システム設定</li>
                        </ol>
                    </nav>
                </div>
                <div class="d-flex gap-2 align-items-center">
                    <span class="environment-badge" :class="getEnvironmentClass(currentEnvironment)" x-text="currentEnvironment.toUpperCase()"></span>
                    <button class="btn btn-outline-secondary" @click="exportConfiguration()">
                        <i class="bi bi-download me-1"></i>設定エクスポート
                    </button>
                    <button class="btn btn-outline-warning" @click="backupConfiguration()">
                        <i class="bi bi-archive me-1"></i>バックアップ作成
                    </button>
                </div>
            </div>
            
            <!-- システム状態概要 -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="system-health" :class="getHealthClass(systemHealth.overall)">
                        <i class="bi" :class="getHealthIcon(systemHealth.overall)" style="font-size: 1.5rem;"></i>
                        <div>
                            <div class="fw-medium">システム状態</div>
                            <small x-text="getHealthText(systemHealth.overall)"></small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <div class="h4 mb-1" x-text="systemStats.activeUsers">342</div>
                            <small class="text-muted">アクティブユーザー</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <div class="h4 mb-1" x-text="systemStats.uptime">99.8%</div>
                            <small class="text-muted">稼働率（今月）</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <div class="h4 mb-1" x-text="systemStats.lastBackup">2時間前</div>
                            <small class="text-muted">最終バックアップ</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- タブナビゲーション -->
            <ul class="nav nav-tabs mb-4" role="tablist">
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'general'}" 
                            @click="setActiveTab('general')" type="button">
                        <i class="bi bi-gear me-1"></i>基本設定
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'security'}" 
                            @click="setActiveTab('security')" type="button">
                        <i class="bi bi-shield-check me-1"></i>セキュリティ
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'performance'}" 
                            @click="setActiveTab('performance')" type="button">
                        <i class="bi bi-speedometer2 me-1"></i>パフォーマンス
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'integration'}" 
                            @click="setActiveTab('integration')" type="button">
                        <i class="bi bi-diagram-3 me-1"></i>サービス連携
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'maintenance'}" 
                            @click="setActiveTab('maintenance')" type="button">
                        <i class="bi bi-tools me-1"></i>メンテナンス
                    </button>
                </li>
                <!-- マスタデータタブ -->
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'masterdata'}" 
                            @click="setActiveTab('masterdata')" type="button">
                        <i class="bi bi-database me-1"></i>マスタデータ
                    </button>
                </li>
                <!-- テンプレートタブ -->
                <li class="nav-item">
                    <button class="nav-link" :class="{'active': activeTab === 'templates'}" 
                            @click="setActiveTab('templates')" type="button">
                        <i class="bi bi-file-earmark-text me-1"></i>テンプレート
                    </button>
                </li>
            </ul>
            
            <!-- 基本設定タブ -->
            <div x-show="activeTab === 'general'" class="tab-content">
                <div class="config-grid">
                    
                    <!-- システム基本情報 -->
                    <div class="setting-card" :class="{'modified': isModified('system')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-info-circle me-2 text-primary"></i>システム基本情報
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>設定済み</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">システム名</label>
                            <input type="text" class="form-control" x-model="config.system.name" @input="markModified('system')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">バージョン</label>
                            <input type="text" class="form-control" x-model="config.system.version" readonly>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">管理者メールアドレス</label>
                            <input type="email" class="form-control" x-model="config.system.adminEmail" @input="markModified('system')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">タイムゾーン</label>
                            <select class="form-select" x-model="config.system.timezone" @change="markModified('system')">
                                <option value="Asia/Tokyo">Asia/Tokyo (JST)</option>
                                <option value="UTC">UTC</option>
                                <option value="America/New_York">America/New_York (EST)</option>
                            </select>
                        </div>
                        <div class="text-end">
                            <button class="btn btn-primary btn-sm" @click="saveConfig('system')" :disabled="!isModified('system')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                    <!-- 認証設定 -->
                    <div class="setting-card" :class="{'modified': isModified('auth')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-shield-lock me-2 text-warning"></i>認証設定
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>Keycloak連携中</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Keycloak サーバーURL</label>
                            <input type="url" class="form-control" x-model="config.auth.keycloakUrl" @input="markModified('auth')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">レルム名</label>
                            <input type="text" class="form-control" x-model="config.auth.realm" @input="markModified('auth')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">クライアントID</label>
                            <input type="text" class="form-control" x-model="config.auth.clientId" @input="markModified('auth')">
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" x-model="config.auth.ssoEnabled" @change="markModified('auth')">
                            <label class="form-check-label">シングルサインオン有効</label>
                        </div>
                        <div class="text-end">
                            <button class="btn btn-outline-secondary btn-sm me-2" @click="testConnection('keycloak')">
                                <i class="bi bi-arrow-repeat me-1"></i>接続テスト
                            </button>
                            <button class="btn btn-primary btn-sm" @click="saveConfig('auth')" :disabled="!isModified('auth')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                    <!-- データベース設定 -->
                    <div class="setting-card" :class="{'modified': isModified('database')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-database me-2 text-info"></i>データベース設定
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>PostgreSQL 15</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">接続プール最大数</label>
                            <input type="number" class="form-control" x-model="config.database.maxPoolSize" 
                                   min="10" max="100" @input="markModified('database')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">接続タイムアウト（秒）</label>
                            <input type="number" class="form-control" x-model="config.database.connectionTimeout" 
                                   min="5" max="60" @input="markModified('database')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">クエリタイムアウト（秒）</label>
                            <input type="number" class="form-control" x-model="config.database.queryTimeout" 
                                   min="10" max="300" @input="markModified('database')">
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" x-model="config.database.readOnlyEnabled" @change="markModified('database')">
                            <label class="form-check-label">読み取り専用レプリカ使用</label>
                        </div>
                        <div class="text-end">
                            <button class="btn btn-outline-secondary btn-sm me-2" @click="testConnection('database')">
                                <i class="bi bi-arrow-repeat me-1"></i>接続テスト
                            </button>
                            <button class="btn btn-primary btn-sm" @click="saveConfig('database')" :disabled="!isModified('database')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                    <!-- メール設定 -->
                    <div class="setting-card" :class="{'modified': isModified('email')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-envelope me-2 text-success"></i>メール設定
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>SMTP設定済み</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">SMTPサーバー</label>
                            <input type="text" class="form-control" x-model="config.email.smtpHost" @input="markModified('email')">
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">ポート</label>
                                    <input type="number" class="form-control" x-model="config.email.smtpPort" @input="markModified('email')">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">暗号化</label>
                                    <select class="form-select" x-model="config.email.encryption" @change="markModified('email')">
                                        <option value="TLS">TLS</option>
                                        <option value="SSL">SSL</option>
                                        <option value="NONE">なし</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">送信者メールアドレス</label>
                            <input type="email" class="form-control" x-model="config.email.fromAddress" @input="markModified('email')">
                        </div>
                        <div class="text-end">
                            <button class="btn btn-outline-secondary btn-sm me-2" @click="sendTestEmail()">
                                <i class="bi bi-envelope me-1"></i>テスト送信
                            </button>
                            <button class="btn btn-primary btn-sm" @click="saveConfig('email')" :disabled="!isModified('email')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <!-- セキュリティタブ -->
            <div x-show="activeTab === 'security'" class="tab-content">
                <div class="config-grid">
                    
                    <!-- パスワードポリシー -->
                    <div class="setting-card" :class="{'modified': isModified('password')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-key me-2 text-warning"></i>パスワードポリシー
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>適用中</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">最小文字数</label>
                            <input type="number" class="form-control" x-model="config.password.minLength" 
                                   min="6" max="50" @input="markModified('password')">
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" x-model="config.password.requireUppercase" @change="markModified('password')">
                                <label class="form-check-label">大文字を含む</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" x-model="config.password.requireNumbers" @change="markModified('password')">
                                <label class="form-check-label">数字を含む</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" x-model="config.password.requireSpecialChars" @change="markModified('password')">
                                <label class="form-check-label">記号を含む</label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">パスワード有効期限（日）</label>
                            <input type="number" class="form-control" x-model="config.password.expiryDays" 
                                   min="30" max="365" @input="markModified('password')">
                        </div>
                        <div class="text-end">
                            <button class="btn btn-primary btn-sm" @click="saveConfig('password')" :disabled="!isModified('password')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                    <!-- セッション設定 -->
                    <div class="setting-card" :class="{'modified': isModified('session')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-clock me-2 text-info"></i>セッション設定
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>設定済み</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">セッションタイムアウト（分）</label>
                            <input type="number" class="form-control" x-model="config.session.timeout" 
                                   min="15" max="480" @input="markModified('session')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">最大ログイン試行回数</label>
                            <input type="number" class="form-control" x-model="config.session.maxLoginAttempts" 
                                   min="3" max="10" @input="markModified('session')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">アカウントロック時間（分）</label>
                            <input type="number" class="form-control" x-model="config.session.lockoutDuration" 
                                   min="5" max="60" @input="markModified('session')">
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" x-model="config.session.rememberMeEnabled" @change="markModified('session')">
                            <label class="form-check-label">ログイン状態を記憶</label>
                        </div>
                        <div class="text-end">
                            <button class="btn btn-primary btn-sm" @click="saveConfig('session')" :disabled="!isModified('session')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <!-- パフォーマンスタブ -->
            <div x-show="activeTab === 'performance'" class="tab-content">
                <div class="config-grid">
                    
                    <!-- キャッシュ設定 -->
                    <div class="setting-card" :class="{'modified': isModified('cache')}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="bi bi-lightning me-2 text-warning"></i>キャッシュ設定
                            </h5>
                            <div class="config-status status-active">
                                <i class="bi bi-check-circle"></i>
                                <span>Redis稼働中</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">キャッシュTTL（秒）</label>
                            <input type="number" class="form-control" x-model="config.cache.defaultTtl" 
                                   min="60" max="86400" @input="markModified('cache')">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">最大メモリ使用量（MB）</label>
                            <input type="number" class="form-control" x-model="config.cache.maxMemory" 
                                   min="256" max="4096" @input="markModified('cache')">
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" x-model="config.cache.enabled" @change="markModified('cache')">
                            <label class="form-check-label">キャッシュ有効</label>
                        </div>
                        <div class="text-end">
                            <button class="btn btn-outline-warning btn-sm me-2" @click="clearCache()">
                                <i class="bi bi-trash me-1"></i>キャッシュクリア
                            </button>
                            <button class="btn btn-primary btn-sm" @click="saveConfig('cache')" :disabled="!isModified('cache')">
                                <i class="bi bi-check me-1"></i>保存
                            </button>
                        </div>
                    </div>
                    
                </div>
            </div>
            
            <!-- マスタデータタブ -->
            <div x-show="activeTab === 'masterdata'" class="tab-content">
                <div class="row">
                    <div class="col-lg-8">
                        <!-- スキルマスタ管理 -->
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="mb-0"><i class="bi bi-gear me-2"></i>スキルマスタ管理</h6>
                                <button class="btn btn-outline-primary btn-sm" @click="addSkillMaster()">
                                    <i class="bi bi-plus me-1"></i>新規追加
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>スキル名</th>
                                                <th>カテゴリ</th>
                                                <th>市場需要</th>
                                                <th>関連スキル</th>
                                                <th>状態</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <template x-for="skill in skillMasters" :key="skill.id">
                                                <tr>
                                                    <td>
                                                        <div x-text="skill.name"></div>
                                                        <div class="small text-muted" x-text="skill.description"></div>
                                                    </td>
                                                    <td>
                                                        <span class="badge bg-light text-dark" x-text="getSkillCategoryText(skill.category)"></span>
                                                    </td>
                                                    <td>
                                                        <span class="badge" :class="getMarketDemandClass(skill.marketDemand)" x-text="getMarketDemandText(skill.marketDemand)"></span>
                                                    </td>
                                                    <td>
                                                        <div class="small">
                                                            <template x-for="relatedSkill in skill.relatedSkills.slice(0, 3)" :key="relatedSkill">
                                                                <span class="badge bg-light text-dark me-1" x-text="relatedSkill"></span>
                                                            </template>
                                                            <span x-show="skill.relatedSkills.length > 3" class="small text-muted">+<span x-text="skill.relatedSkills.length - 3"></span></span>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <span class="badge" :class="skill.isActive ? 'bg-success' : 'bg-secondary'" x-text="skill.isActive ? 'アクティブ' : '無効'"></span>
                                                    </td>
                                                    <td>
                                                        <div class="btn-group btn-group-sm">
                                                            <button class="btn btn-outline-primary" @click="editSkillMaster(skill.id)" title="編集">
                                                                <i class="bi bi-pencil"></i>
                                                            </button>
                                                            <button class="btn btn-outline-warning" @click="toggleSkillStatus(skill.id)" :title="skill.isActive ? '無効化' : '有効化'">
                                                                <i class="bi" :class="skill.isActive ? 'bi-toggle-on' : 'bi-toggle-off'"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </template>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- スキルカテゴリ管理 -->
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="bi bi-tags me-2"></i>スキルカテゴリ管理</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <template x-for="category in skillCategories" :key="category.id">
                                        <div class="col-md-6 col-lg-4 mb-3">
                                            <div class="card border">
                                                <div class="card-body p-3">
                                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                                        <h6 class="mb-0" x-text="category.name"></h6>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" x-model="category.isActive" @change="toggleCategoryStatus(category.id)">
                                                        </div>
                                                    </div>
                                                    <div class="small text-muted mb-2" x-text="category.value"></div>
                                                    <div class="small">
                                                        <span class="badge bg-light text-dark" x-text="getSkillCountByCategory(category.value)">件</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <!-- マスタデータ統計 -->
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="bi bi-bar-chart me-2"></i>マスタデータ統計</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between mb-1">
                                        <span class="small">総スキル数</span>
                                        <span class="small fw-bold" x-text="skillMasters.length"></span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-1">
                                        <span class="small">アクティブスキル</span>
                                        <span class="small fw-bold" x-text="skillMasters.filter(s => s.isActive).length"></span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-1">
                                        <span class="small">高需要スキル</span>
                                        <span class="small fw-bold" x-text="skillMasters.filter(s => s.marketDemand === 'VERY_HIGH').length"></span>
                                    </div>
                                </div>
                                
                                <hr>
                                
                                <h6 class="small mb-2">カテゴリ別分布</h6>
                                <template x-for="category in skillCategories.filter(c => c.isActive)" :key="category.id">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span class="small" x-text="category.name"></span>
                                        <div class="d-flex align-items-center">
                                            <div class="progress me-2" style="width: 80px; height: 8px;">
                                                <div class="progress-bar" :style="`width: ${(getSkillCountByCategory(category.value) / skillMasters.length) * 100}%`"></div>
                                            </div>
                                            <span class="small" x-text="getSkillCountByCategory(category.value)"></span>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- テンプレートタブ -->
            <div x-show="activeTab === 'templates'" class="tab-content">
                <div class="row">
                    <div class="col-lg-8">
                        <!-- テンプレート管理 -->
                        <div class="card">
                            <div class="card-header">
                                <ul class="nav nav-tabs card-header-tabs">
                                    <li class="nav-item">
                                        <button class="nav-link" :class="{ active: templateTab === 'invoice' }" @click="templateTab = 'invoice'">
                                            <i class="bi bi-receipt me-1"></i>請求書
                                        </button>
                                    </li>
                                    <li class="nav-item">
                                        <button class="nav-link" :class="{ active: templateTab === 'timesheet' }" @click="templateTab = 'timesheet'">
                                            <i class="bi bi-clock me-1"></i>勤怠
                                        </button>
                                    </li>
                                    <li class="nav-item">
                                        <button class="nav-link" :class="{ active: templateTab === 'contract' }" @click="templateTab = 'contract'">
                                            <i class="bi bi-file-earmark-text me-1"></i>契約
                                        </button>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-body">
                                <!-- 請求書テンプレート -->
                                <div x-show="templateTab === 'invoice'">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6 class="mb-0">請求書テンプレート管理</h6>
                                        <button class="btn btn-outline-primary btn-sm" @click="addTemplate('invoice')">
                                            <i class="bi bi-plus me-1"></i>新規作成
                                        </button>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>テンプレート名</th>
                                                    <th>対象顧客</th>
                                                    <th>変数数</th>
                                                    <th>状態</th>
                                                    <th>更新日</th>
                                                    <th>操作</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <template x-for="template in templates.invoice" :key="template.id">
                                                    <tr>
                                                        <td>
                                                            <div x-text="template.templateName"></div>
                                                            <div x-show="template.isDefault" class="small text-muted">
                                                                <i class="bi bi-star-fill text-warning"></i> デフォルト
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span x-text="template.customerId ? '個別顧客' : '共通'"></span>
                                                        </td>
                                                        <td>
                                                            <span class="badge bg-light text-dark" x-text="template.variables?.length || 0"></span>
                                                        </td>
                                                        <td>
                                                            <span class="badge" :class="template.isActive ? 'bg-success' : 'bg-secondary'" x-text="template.isActive ? 'アクティブ' : '無効'"></span>
                                                        </td>
                                                        <td>
                                                            <span class="small" x-text="formatDate(template.updatedAt)"></span>
                                                        </td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm">
                                                                <button class="btn btn-outline-primary" @click="editTemplate('invoice', template.id)" title="編集">
                                                                    <i class="bi bi-pencil"></i>
                                                                </button>
                                                                <button class="btn btn-outline-info" @click="previewTemplate('invoice', template.id)" title="プレビュー">
                                                                    <i class="bi bi-eye"></i>
                                                                </button>
                                                                <button class="btn btn-outline-secondary" @click="duplicateTemplate('invoice', template.id)" title="複製">
                                                                    <i class="bi bi-copy"></i>
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- 勤怠テンプレート -->
                                <div x-show="templateTab === 'timesheet'">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6 class="mb-0">勤怠テンプレート管理</h6>
                                        <button class="btn btn-outline-primary btn-sm" @click="addTemplate('timesheet')">
                                            <i class="bi bi-plus me-1"></i>新規作成
                                        </button>
                                    </div>
                                    <div class="row">
                                        <template x-for="template in templates.timesheet" :key="template.id">
                                            <div class="col-md-6 mb-3">
                                                <div class="card border">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                                            <h6 class="mb-0" x-text="template.templateName"></h6>
                                                            <span class="badge" :class="template.isActive ? 'bg-success' : 'bg-secondary'" x-text="template.isActive ? 'アクティブ' : '無効'"></span>
                                                        </div>
                                                        <div class="small text-muted mb-2" x-text="template.description"></div>
                                                        <div class="mb-2">
                                                            <span class="badge bg-light text-dark" x-text="template.templateType"></span>
                                                            <span x-show="template.isDefault" class="badge bg-warning ms-1">デフォルト</span>
                                                        </div>
                                                        <div class="small mb-3">
                                                            フィールド数: <span x-text="template.fields?.length || 0"></span>
                                                        </div>
                                                        <div class="d-flex gap-1">
                                                            <button class="btn btn-outline-primary btn-sm flex-fill" @click="editTemplate('timesheet', template.id)">
                                                                <i class="bi bi-pencil"></i>
                                                            </button>
                                                            <button class="btn btn-outline-info btn-sm flex-fill" @click="previewTemplate('timesheet', template.id)">
                                                                <i class="bi bi-eye"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                                
                                <!-- 契約テンプレート -->
                                <div x-show="templateTab === 'contract'">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <h6 class="mb-0">契約テンプレート管理</h6>
                                        <button class="btn btn-outline-primary btn-sm" @click="addTemplate('contract')">
                                            <i class="bi bi-plus me-1"></i>新規作成
                                        </button>
                                    </div>
                                    <div class="row">
                                        <template x-for="template in templates.contract" :key="template.id">
                                            <div class="col-md-6 mb-3">
                                                <div class="card border">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-start mb-2">
                                                            <h6 class="mb-0" x-text="template.templateName"></h6>
                                                            <span class="badge" :class="template.isActive ? 'bg-success' : 'bg-secondary'" x-text="template.isActive ? 'アクティブ' : '無効'"></span>
                                                        </div>
                                                        <div class="mb-2">
                                                            <span class="badge bg-light text-dark" x-text="template.contractType"></span>
                                                            <span class="badge bg-light text-dark ms-1" x-text="template.documentType"></span>
                                                        </div>
                                                        <div class="small mb-3">
                                                            変数数: <span x-text="template.variables?.length || 0"></span>
                                                        </div>
                                                        <div class="d-flex gap-1">
                                                            <button class="btn btn-outline-primary btn-sm flex-fill" @click="editTemplate('contract', template.id)">
                                                                <i class="bi bi-pencil"></i>
                                                            </button>
                                                            <button class="btn btn-outline-info btn-sm flex-fill" @click="previewTemplate('contract', template.id)">
                                                                <i class="bi bi-eye"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <!-- テンプレート統計 -->
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="bi bi-pie-chart me-2"></i>テンプレート統計</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between mb-2">
                                        <span class="small">請求書テンプレート</span>
                                        <span class="badge bg-primary" x-text="templates.invoice.length"></span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span class="small">勤怠テンプレート</span>
                                        <span class="badge bg-info" x-text="templates.timesheet.length"></span>
                                    </div>
                                    <div class="d-flex justify-content-between mb-2">
                                        <span class="small">契約テンプレート</span>
                                        <span class="badge bg-success" x-text="templates.contract.length"></span>
                                    </div>
                                </div>
                                
                                <hr>
                                
                                <h6 class="small mb-2">利用状況</h6>
                                <div class="d-flex justify-content-between mb-1">
                                    <span class="small">アクティブ</span>
                                    <span class="small fw-bold" x-text="getTotalActiveTemplates()"></span>
                                </div>
                                <div class="d-flex justify-content-between mb-1">
                                    <span class="small">デフォルト</span>
                                    <span class="small fw-bold" x-text="getTotalDefaultTemplates()"></span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span class="small">個別顧客用</span>
                                    <span class="small fw-bold" x-text="getCustomerSpecificTemplates()"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 業務ルール設定 -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h6 class="mb-0"><i class="bi bi-gear me-2"></i>業務ルール設定</h6>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">最大残業時間（月）</label>
                                    <input type="number" class="form-control" x-model="systemConfiguration.businessRules.maxOvertimeHours" min="0" max="100">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">自動承認限度額</label>
                                    <input type="number" class="form-control" x-model="systemConfiguration.businessRules.autoApprovalLimit" min="0">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">請求書番号形式</label>
                                    <input type="text" class="form-control" x-model="systemConfiguration.businessRules.invoiceNumberFormat">
                                    <div class="form-text">例: INV-{YYYY}-{###}</div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">会計年度開始月</label>
                                    <select class="form-select" x-model="systemConfiguration.businessRules.fiscalYearStart">
                                        <option value="1">1月</option>
                                        <option value="4">4月</option>
                                        <option value="7">7月</option>
                                        <option value="10">10月</option>
                                    </select>
                                </div>
                                <div class="text-end">
                                    <button class="btn btn-primary btn-sm" @click="saveBusinessRules()">
                                        <i class="bi bi-check me-1"></i>保存
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </main>
    
    <!-- JavaScript -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('systemSettings', () => ({
                activeTab: 'general',
                templateTab: 'invoice',
                currentEnvironment: 'production',
                modifiedSections: new Set(),
                
                systemHealth: {
                    overall: 'excellent'
                },
                
                systemStats: {
                    activeUsers: 342,
                    uptime: '99.8%',
                    lastBackup: '2時間前'
                },
                
                // Master Data Management
                skillCategories: [
                    { id: 'programming-language', name: 'プログラミング言語', value: 'PROGRAMMING_LANGUAGE', isActive: true },
                    { id: 'framework', name: 'フレームワーク', value: 'FRAMEWORK', isActive: true },
                    { id: 'database', name: 'データベース', value: 'DATABASE', isActive: true },
                    { id: 'cloud', name: 'クラウド', value: 'CLOUD', isActive: true },
                    { id: 'devops', name: 'DevOps', value: 'DEVOPS', isActive: true },
                    { id: 'frontend', name: 'フロントエンド', value: 'FRONTEND', isActive: true },
                    { id: 'backend', name: 'バックエンド', value: 'BACKEND', isActive: true },
                    { id: 'mobile', name: 'モバイル', value: 'MOBILE', isActive: true },
                    { id: 'testing', name: 'テスト', value: 'TESTING', isActive: true },
                    { id: 'project-management', name: 'プロジェクト管理', value: 'PROJECT_MANAGEMENT', isActive: true },
                    { id: 'business-skill', name: 'ビジネススキル', value: 'BUSINESS_SKILL', isActive: true },
                    { id: 'other', name: 'その他', value: 'OTHER', isActive: true }
                ],
                
                skillMasters: [
                    {
                        id: '550e8400-e29b-41d4-a716-446655440001',
                        name: 'Java',
                        category: 'PROGRAMMING_LANGUAGE',
                        description: 'オブジェクト指向プログラミング言語',
                        aliases: ['java', 'JAVA'],
                        relatedSkills: ['Spring', 'Spring Boot'],
                        marketDemand: 'HIGH',
                        isActive: true,
                        createdAt: '2025-01-01T00:00:00Z'
                    },
                    {
                        id: '660f9511-f39c-52e5-b827-557766551002',
                        name: 'React',
                        category: 'FRONTEND',
                        description: 'JavaScriptライブラリ',
                        aliases: ['react', 'ReactJS'],
                        relatedSkills: ['JavaScript', 'TypeScript', 'Next.js'],
                        marketDemand: 'VERY_HIGH',
                        isActive: true,
                        createdAt: '2025-01-01T00:00:00Z'
                    },
                    {
                        id: '770a8622-a4ad-63f6-c938-668877662003',
                        name: 'Spring Boot',
                        category: 'FRAMEWORK',
                        description: 'JavaのWebアプリケーションフレームワーク',
                        aliases: ['springboot'],
                        relatedSkills: ['Java', 'Spring Framework', 'Maven'],
                        marketDemand: 'HIGH',
                        isActive: true,
                        createdAt: '2025-01-01T00:00:00Z'
                    }
                ],
                
                templates: {
                    invoice: [
                        {
                            id: '880b9733-b5be-74g7-d049-779988773004',
                            templateName: '標準請求書テンプレート',
                            customerId: null,
                            isDefault: true,
                            isActive: true,
                            templateContent: '<div>{{companyName}}様<br/>請求書番号: {{invoiceNumber}}</div>',
                            variables: [
                                { name: 'companyName', placeholder: '{{companyName}}', description: '会社名', required: true },
                                { name: 'invoiceNumber', placeholder: '{{invoiceNumber}}', description: '請求書番号', required: true }
                            ],
                            createdAt: '2025-01-01T00:00:00Z',
                            updatedAt: '2025-01-01T00:00:00Z'
                        }
                    ],
                    timesheet: [
                        {
                            id: '990c4844-c6cf-85h8-e15a-88aa99884005',
                            templateName: '月次勤怠テンプレート',
                            description: '標準的な月次勤怠報告書テンプレート',
                            templateType: 'MONTHLY_REPORT',
                            fields: [
                                { fieldName: 'workDays', displayName: '出勤日数', fieldType: 'NUMBER', required: true },
                                { fieldName: 'totalHours', displayName: '総労働時間', fieldType: 'NUMBER', required: true }
                            ],
                            isDefault: true,
                            isActive: true,
                            createdAt: '2025-01-01T00:00:00Z'
                        }
                    ],
                    contract: [
                        {
                            id: 'aa0d5955-d7da-96i9-f26b-99bb00995006',
                            templateName: 'SES契約書テンプレート',
                            contractType: 'SES_CONTRACT',
                            documentType: 'CONTRACT',
                            templateContent: 'SES業務委託契約書テンプレート内容...',
                            variables: [
                                { name: 'clientName', placeholder: '{{clientName}}', description: 'クライアント名', required: true },
                                { name: 'projectName', placeholder: '{{projectName}}', description: 'プロジェクト名', required: true }
                            ],
                            isDefault: true,
                            isActive: true,
                            createdAt: '2025-01-01T00:00:00Z'
                        }
                    ]
                },
                
                systemConfiguration: {
                    dataRetention: {
                        auditLogDays: 2555, // 7年
                        timesheetDataDays: 1825, // 5年
                        invoiceDataDays: 2555, // 7年
                        temporaryFilesDays: 30
                    },
                    businessRules: {
                        maxOvertimeHours: 45,
                        autoApprovalLimit: 1000000,
                        invoiceNumberFormat: 'INV-{YYYY}-{###}',
                        fiscalYearStart: 4 // April
                    },
                    notification: {
                        slackWebhookUrl: 'https://hooks.slack.com/services/...',
                        emailFrom: 'noreply@ses-mgr.com',
                        reminderDays: [7, 3, 1]
                    }
                },
                
                config: {
                    system: {
                        name: 'SES業務システム',
                        version: '2.1.0',
                        adminEmail: 'admin@ses-mgr.com',
                        timezone: 'Asia/Tokyo'
                    },
                    auth: {
                        keycloakUrl: 'https://auth.ses-mgr.com',
                        realm: 'ses-mgr',
                        clientId: 'ses-web-app',
                        ssoEnabled: true
                    },
                    database: {
                        maxPoolSize: 30,
                        connectionTimeout: 20,
                        queryTimeout: 60,
                        readOnlyEnabled: true
                    },
                    email: {
                        smtpHost: 'smtp.ses-mgr.com',
                        smtpPort: 587,
                        encryption: 'TLS',
                        fromAddress: 'noreply@ses-mgr.com'
                    },
                    password: {
                        minLength: 8,
                        requireUppercase: true,
                        requireNumbers: true,
                        requireSpecialChars: true,
                        expiryDays: 90
                    },
                    session: {
                        timeout: 120,
                        maxLoginAttempts: 5,
                        lockoutDuration: 15,
                        rememberMeEnabled: true
                    },
                    cache: {
                        defaultTtl: 3600,
                        maxMemory: 1024,
                        enabled: true
                    }
                },
                
                setActiveTab(tab) {
                    this.activeTab = tab;
                },
                
                markModified(section) {
                    this.modifiedSections.add(section);
                },
                
                isModified(section) {
                    return this.modifiedSections.has(section);
                },
                
                saveConfig(section) {
                    console.log(`Saving config for ${section}:`, this.config[section]);
                    this.modifiedSections.delete(section);
                    // API呼び出し実装
                    alert(`${section}の設定を保存しました。`);
                },
                
                getEnvironmentClass(env) {
                    const classes = {
                        'production': 'env-production',
                        'staging': 'env-staging',
                        'development': 'env-development'
                    };
                    return classes[env] || 'env-development';
                },
                
                getHealthClass(health) {
                    const classes = {
                        'excellent': 'health-excellent',
                        'good': 'health-good',
                        'warning': 'health-warning',
                        'critical': 'health-critical'
                    };
                    return classes[health] || 'health-warning';
                },
                
                getHealthIcon(health) {
                    const icons = {
                        'excellent': 'bi-heart-fill',
                        'good': 'bi-heart',
                        'warning': 'bi-exclamation-triangle',
                        'critical': 'bi-x-octagon'
                    };
                    return icons[health] || 'bi-question-circle';
                },
                
                getHealthText(health) {
                    const texts = {
                        'excellent': '優良',
                        'good': '良好',
                        'warning': '警告',
                        'critical': '危険'
                    };
                    return texts[health] || '不明';
                },
                
                testConnection(service) {
                    console.log(`Testing connection to ${service}`);
                    alert(`${service}への接続テストを実行中...`);
                },
                
                sendTestEmail() {
                    console.log('Sending test email');
                    alert('テストメールを送信しました。');
                },
                
                clearCache() {
                    if (confirm('キャッシュをクリアしますか？パフォーマンスに一時的な影響があります。')) {
                        console.log('Clearing cache');
                        alert('キャッシュをクリアしました。');
                    }
                },
                
                exportConfiguration() {
                    console.log('Exporting configuration');
                    alert('設定をエクスポート中...');
                },
                
                backupConfiguration() {
                    console.log('Creating backup');
                    alert('設定のバックアップを作成中...');
                },
                
                toggleSidebar() {
                    console.log('Toggle sidebar');
                },
                
                // Master Data Management Methods
                getSkillCategoryText(value) {
                    const category = this.skillCategories.find(c => c.value === value);
                    return category ? category.name : value;
                },
                
                getMarketDemandText(demand) {
                    const texts = {
                        'LOW': '低',
                        'MEDIUM': '中',
                        'HIGH': '高',
                        'VERY_HIGH': '非常に高'
                    };
                    return texts[demand] || demand;
                },
                
                getMarketDemandClass(demand) {
                    const classes = {
                        'LOW': 'bg-secondary',
                        'MEDIUM': 'bg-info', 
                        'HIGH': 'bg-warning',
                        'VERY_HIGH': 'bg-danger'
                    };
                    return classes[demand] || 'bg-secondary';
                },
                
                getSkillCountByCategory(category) {
                    return this.skillMasters.filter(skill => skill.category === category).length;
                },
                
                addSkillMaster() {
                    console.log('スキルマスタ追加');
                    // 新規スキルマスタ追加モーダルを開く実装
                },
                
                editSkillMaster(id) {
                    console.log('スキルマスタ編集:', id);
                    // スキルマスタ編集モーダルを開く実装
                },
                
                toggleSkillStatus(id) {
                    const skill = this.skillMasters.find(s => s.id === id);
                    if (skill) {
                        skill.isActive = !skill.isActive;
                    }
                },
                
                toggleCategoryStatus(id) {
                    const category = this.skillCategories.find(c => c.id === id);
                    if (category) {
                        category.isActive = !category.isActive;
                    }
                },
                
                // Template Management Methods
                getTotalActiveTemplates() {
                    return Object.values(this.templates)
                        .flat()
                        .filter(t => t.isActive).length;
                },
                
                getTotalDefaultTemplates() {
                    return Object.values(this.templates)
                        .flat()
                        .filter(t => t.isDefault).length;
                },
                
                getCustomerSpecificTemplates() {
                    return Object.values(this.templates)
                        .flat()
                        .filter(t => t.customerId).length;
                },
                
                addTemplate(type) {
                    console.log('テンプレート追加:', type);
                    // テンプレート作成モーダルを開く実装
                },
                
                editTemplate(type, id) {
                    console.log('テンプレート編集:', type, id);
                    // テンプレート編集モーダルを開く実装
                },
                
                previewTemplate(type, id) {
                    console.log('テンプレートプレビュー:', type, id);
                    // テンプレートプレビューモーダルを開く実装
                },
                
                duplicateTemplate(type, id) {
                    console.log('テンプレート複製:', type, id);
                    // テンプレート複製実装
                },
                
                saveBusinessRules() {
                    console.log('業務ルール保存', this.systemConfiguration.businessRules);
                    alert('業務ルールを保存しました。');
                },
                
                formatDate(dateStr) {
                    if (!dateStr) return '';
                    return new Date(dateStr).toLocaleDateString('ja-JP');
                }
            }));
        });
    </script>
</body>
</html>