<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÄöÁü•Ë®≠ÂÆö„Éª„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ - SESÊ•≠Âãô„Ç∑„Çπ„ÉÜ„É†</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
    
    <!-- „Ç´„Çπ„Çø„É†CSS -->
    <style>
        :root {
            --sidebar-width: 280px;
            --header-height: 60px;
            --ses-primary: #0d6efd;
            --ses-secondary: #6c757d;
            --ses-success: #198754;
            --ses-warning: #ffc107;
            --ses-danger: #dc3545;
            --ses-light: #f8f9fa;
            --notification-email: #0ea5e9;
            --notification-slack: #4a154b;
            --notification-push: #059669;
            --notification-sms: #dc2626;
        }
        
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            min-height: calc(100vh - var(--header-height));
        }
        
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background-color: #212529;
            z-index: 1000;
        }
        
        .navbar {
            height: var(--header-height);
            background-color: #ffffff !important;
            border-bottom: 1px solid #dee2e6;
        }

        .settings-nav {
            border-right: 1px solid #dee2e6;
            background-color: #f8f9fa;
            min-height: calc(100vh - var(--header-height) - 2rem);
        }

        .settings-nav .nav-link {
            border-radius: 0;
            border: none;
            color: #495057;
            padding: 1rem 1.5rem;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .settings-nav .nav-link.active {
            background-color: var(--ses-primary);
            color: white;
        }

        .settings-nav .nav-link:hover:not(.active) {
            background-color: #e9ecef;
        }

        .settings-content {
            background-color: white;
            min-height: calc(100vh - var(--header-height) - 2rem);
        }

        .template-card {
            border: 1px solid #e9ecef;
            border-radius: 0.5rem;
            transition: all 0.15s ease-in-out;
            cursor: pointer;
        }

        .template-card:hover {
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .template-card.active {
            border-color: var(--ses-primary);
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }

        .template-type-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-weight: 500;
        }

        .template-type-email { background-color: var(--notification-email); color: white; }
        .template-type-slack { background-color: var(--notification-slack); color: white; }
        .template-type-push { background-color: var(--notification-push); color: white; }
        .template-type-sms { background-color: var(--notification-sms); color: white; }

        .variable-input {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
        }

        .variable-tag {
            background-color: #e0e7ff;
            color: #3730a3;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-family: 'Courier New', monospace;
            margin: 0.125rem;
            display: inline-block;
            cursor: pointer;
        }

        .delivery-config-card {
            border: 2px solid #e9ecef;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .delivery-config-card.email {
            border-color: var(--notification-email);
            background-color: rgba(14, 165, 233, 0.05);
        }

        .delivery-config-card.slack {
            border-color: var(--notification-slack);
            background-color: rgba(74, 21, 75, 0.05);
        }

        .delivery-config-card.push {
            border-color: var(--notification-push);
            background-color: rgba(5, 150, 105, 0.05);
        }

        .delivery-config-card.sms {
            border-color: var(--notification-sms);
            background-color: rgba(220, 38, 38, 0.05);
        }

        .connection-status {
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .connection-status.connected {
            background-color: #dcfce7;
            color: #166534;
        }

        .connection-status.disconnected {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .rule-item {
            border: 1px solid #e9ecef;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }

        .rule-item.active {
            border-color: var(--ses-success);
            background-color: #f0fdf4;
        }

        .rule-item.inactive {
            border-color: #d1d5db;
            background-color: #f9fafb;
            opacity: 0.7;
        }

        .preview-area {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 0.375rem;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            min-height: 200px;
            white-space: pre-wrap;
        }

        .form-switch .form-check-input {
            width: 3rem;
            height: 1.5rem;
        }

        .code-editor {
            font-family: 'Courier New', monospace;
            background-color: #1e1e1e;
            color: #d4d4d4;
            border-radius: 0.375rem;
            padding: 1rem;
            min-height: 300px;
        }

        .stats-badge {
            background-color: var(--ses-light);
            color: var(--ses-secondary);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="#" style="color: var(--ses-primary);">
                <i class="bi bi-layers me-2"></i>SESÊ•≠Âãô„Ç∑„Çπ„ÉÜ„É†
            </a>
            <div class="d-flex align-items-center">
                <span class="me-3">ÁÆ°ÁêÜËÄÖ: Áî∞‰∏≠Â§™ÈÉé</span>
                <button class="btn btn-outline-secondary btn-sm">
                    <i class="bi bi-box-arrow-right"></i> „É≠„Ç∞„Ç¢„Ç¶„Éà
                </button>
            </div>
        </div>
    </nav>

    <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
    <div class="sidebar">
        <nav class="nav flex-column p-3">
            <a class="nav-link text-white mb-2" href="#"><i class="bi bi-speedometer2 me-2"></i>„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-folder me-2"></i>Ê°à‰ª∂ÁÆ°ÁêÜ</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-people me-2"></i>ÊäÄË°ìËÄÖÁÆ°ÁêÜ</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-search-heart me-2"></i>„Éû„ÉÉ„ÉÅ„É≥„Ç∞</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-file-earmark-text me-2"></i>Â•ëÁ¥ÑÁÆ°ÁêÜ</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-clock me-2"></i>Âã§ÊÄ†„ÉªÂ∑•Êï∞</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-receipt me-2"></i>Ë´ãÊ±Ç„ÉªÊîØÊâï</a>
            <a class="nav-link text-white bg-primary rounded mb-2" href="#"><i class="bi bi-bell me-2"></i>ÈÄöÁü•ÁÆ°ÁêÜ</a>
            <a class="nav-link text-light mb-2" href="#"><i class="bi bi-graph-up me-2"></i>„É¨„Éù„Éº„Éà</a>
        </nav>
    </div>

    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
    <div class="main-content">
        <div class="container-fluid p-4" x-data="notificationSettings()">
            <!-- „Éö„Éº„Ç∏„Éò„ÉÉ„ÉÄ„Éº -->
            <div class="row mb-4">
                <div class="col">
                    <h2 class="mb-1">
                        <i class="bi bi-gear me-2"></i>ÈÄöÁü•Ë®≠ÂÆö„Éª„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ
                    </h2>
                    <p class="text-muted mb-0">ÈÄöÁü•„Ç∑„Çπ„ÉÜ„É†„ÅÆË®≠ÂÆö„Å®„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÁÆ°ÁêÜ„Åó„Åæ„Åô</p>
                </div>
                <div class="col-auto">
                    <button class="btn btn-primary" @click="saveAllSettings()">
                        <i class="bi bi-check-circle me-1"></i>Ë®≠ÂÆö„Çí‰øùÂ≠ò
                    </button>
                </div>
            </div>

            <div class="row">
                <!-- Ë®≠ÂÆö„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
                <div class="col-md-3">
                    <div class="settings-nav">
                        <div class="nav flex-column nav-pills">
                            <button class="nav-link" 
                                    :class="{ 'active': activeTab === 'templates' }"
                                    @click="activeTab = 'templates'">
                                <i class="bi bi-file-earmark-text me-2"></i>„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ
                            </button>
                            <button class="nav-link"
                                    :class="{ 'active': activeTab === 'delivery' }"
                                    @click="activeTab = 'delivery'">
                                <i class="bi bi-send me-2"></i>ÈÖç‰ø°Ë®≠ÂÆö
                            </button>
                            <button class="nav-link"
                                    :class="{ 'active': activeTab === 'rules' }"
                                    @click="activeTab = 'rules'">
                                <i class="bi bi-diagram-3 me-2"></i>ÈÄöÁü•„É´„Éº„É´
                            </button>
                            <button class="nav-link"
                                    :class="{ 'active': activeTab === 'preferences' }"
                                    @click="activeTab = 'preferences'">
                                <i class="bi bi-person-gear me-2"></i>„É¶„Éº„Ç∂„ÉºË®≠ÂÆö
                            </button>
                            <button class="nav-link"
                                    :class="{ 'active': activeTab === 'system' }"
                                    @click="activeTab = 'system'">
                                <i class="bi bi-gear-wide-connected me-2"></i>„Ç∑„Çπ„ÉÜ„É†Ë®≠ÂÆö
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ë®≠ÂÆö„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
                <div class="col-md-9">
                    <div class="settings-content p-4">
                        
                        <!-- „ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ„Çø„Éñ -->
                        <div x-show="activeTab === 'templates'">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4>ÈÄöÁü•„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ</h4>
                                <button class="btn btn-success" @click="createNewTemplate()">
                                    <i class="bi bi-plus-circle me-1"></i>Êñ∞Ë¶è„ÉÜ„É≥„Éó„É¨„Éº„Éà
                                </button>
                            </div>

                            <div class="row">
                                <!-- „ÉÜ„É≥„Éó„É¨„Éº„Éà‰∏ÄË¶ß -->
                                <div class="col-md-4">
                                    <h6 class="mb-3">„ÉÜ„É≥„Éó„É¨„Éº„Éà‰∏ÄË¶ß</h6>
                                    <template x-for="template in templates" :key="template.id">
                                        <div class="template-card p-3 mb-3"
                                             :class="{ 'active': selectedTemplate?.id === template.id }"
                                             @click="selectTemplate(template)">
                                            <div class="d-flex justify-content-between align-items-start mb-2">
                                                <h6 class="mb-1" x-text="template.name"></h6>
                                                <span class="template-type-badge" 
                                                      :class="'template-type-' + template.type.toLowerCase()"
                                                      x-text="template.type">
                                                </span>
                                            </div>
                                            <p class="text-muted mb-2 small" x-text="template.description"></p>
                                            <div class="d-flex justify-content-between align-items-center">
                                                <small class="text-muted">
                                                    v<span x-text="template.version"></span>
                                                </small>
                                                <div>
                                                    <span class="stats-badge me-1">
                                                        <span x-text="template.usageCount"></span>Âõû‰ΩøÁî®
                                                    </span>
                                                    <template x-if="template.isActive">
                                                        <span class="badge bg-success">ÊúâÂäπ</span>
                                                    </template>
                                                    <template x-if="!template.isActive">
                                                        <span class="badge bg-secondary">ÁÑ°Âäπ</span>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                </div>

                                <!-- „ÉÜ„É≥„Éó„É¨„Éº„ÉàÁ∑®ÈõÜ -->
                                <div class="col-md-8">
                                    <template x-if="selectedTemplate">
                                        <div>
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <h6>„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁ∑®ÈõÜ</h6>
                                                <div class="btn-group">
                                                    <button class="btn btn-outline-primary btn-sm" @click="previewTemplate()">
                                                        <i class="bi bi-eye me-1"></i>„Éó„É¨„Éì„É•„Éº
                                                    </button>
                                                    <button class="btn btn-outline-success btn-sm" @click="saveTemplate()">
                                                        <i class="bi bi-check me-1"></i>‰øùÂ≠ò
                                                    </button>
                                                    <button class="btn btn-outline-danger btn-sm" @click="deleteTemplate()">
                                                        <i class="bi bi-trash me-1"></i>ÂâäÈô§
                                                    </button>
                                                </div>
                                            </div>

                                            <form>
                                                <div class="row g-3 mb-4">
                                                    <div class="col-md-6">
                                                        <label class="form-label">„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂêç</label>
                                                        <input type="text" class="form-control" x-model="selectedTemplate.name">
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="form-label">ÈÄöÁü•„Çø„Ç§„Éó</label>
                                                        <select class="form-select" x-model="selectedTemplate.type">
                                                            <option value="EMAIL">Email</option>
                                                            <option value="SLACK">Slack</option>
                                                            <option value="PUSH">PushÈÄöÁü•</option>
                                                            <option value="SMS">SMS</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-12">
                                                        <label class="form-label">Ë™¨Êòé</label>
                                                        <input type="text" class="form-control" x-model="selectedTemplate.description">
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label class="form-label">„Ç´„ÉÜ„Ç¥„É™</label>
                                                        <select class="form-select" x-model="selectedTemplate.category">
                                                            <option value="project">„Éó„É≠„Ç∏„Çß„ÇØ„Éà</option>
                                                            <option value="engineer">ÊäÄË°ìËÄÖ</option>
                                                            <option value="contract">Â•ëÁ¥Ñ</option>
                                                            <option value="timesheet">Âã§ÊÄ†</option>
                                                            <option value="billing">Ë´ãÊ±Ç</option>
                                                            <option value="system">„Ç∑„Çπ„ÉÜ„É†</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" x-model="selectedTemplate.isActive">
                                                            <label class="form-check-label">ÊúâÂäπ</label>
                                                        </div>
                                                    </div>
                                                </div>

                                                <template x-if="selectedTemplate.type === 'EMAIL'">
                                                    <div class="mb-3">
                                                        <label class="form-label">‰ª∂Âêç</label>
                                                        <input type="text" class="form-control" x-model="selectedTemplate.subject">
                                                    </div>
                                                </template>

                                                <div class="mb-3">
                                                    <label class="form-label">Êú¨Êñá„ÉÜ„É≥„Éó„É¨„Éº„Éà</label>
                                                    <div class="mb-2">
                                                        <small class="text-muted">
                                                            ‰ΩøÁî®ÂèØËÉΩ„Å™Â§âÊï∞: 
                                                            <template x-for="variable in availableVariables" :key="variable">
                                                                <span class="variable-tag" @click="insertVariable(variable)">
                                                                    {{<span x-text="variable"></span>}}
                                                                </span>
                                                            </template>
                                                        </small>
                                                    </div>
                                                    <textarea class="form-control" rows="10" x-model="selectedTemplate.bodyTemplate"></textarea>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <h6>„Éó„É¨„Éì„É•„Éº</h6>
                                                        <div class="preview-area" x-text="getTemplatePreview()"></div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <h6>Â§âÊï∞Ë®≠ÂÆö</h6>
                                                        <template x-for="variable in selectedTemplate.variables" :key="variable.name">
                                                            <div class="mb-2">
                                                                <div class="input-group input-group-sm">
                                                                    <span class="input-group-text" x-text="variable.name"></span>
                                                                    <input type="text" class="form-control variable-input" 
                                                                           :placeholder="variable.type"
                                                                           x-model="previewValues[variable.name]">
                                                                    <button class="btn btn-outline-danger" @click="removeVariable(variable.name)">
                                                                        <i class="bi bi-x"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </template>
                                                        <button class="btn btn-outline-primary btn-sm" @click="addVariable()">
                                                            <i class="bi bi-plus"></i> Â§âÊï∞ËøΩÂä†
                                                        </button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </template>
                                    <template x-if="!selectedTemplate">
                                        <div class="text-center text-muted py-5">
                                            <i class="bi bi-file-earmark-text fs-1 mb-3"></i>
                                            <p>„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>

                        <!-- ÈÖç‰ø°Ë®≠ÂÆö„Çø„Éñ -->
                        <div x-show="activeTab === 'delivery'">
                            <h4 class="mb-4">ÈÖç‰ø°Ë®≠ÂÆö</h4>

                            <!-- EmailË®≠ÂÆö -->
                            <div class="delivery-config-card email">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="mb-0">
                                        <i class="bi bi-envelope me-2"></i>EmailÈÖç‰ø°Ë®≠ÂÆö
                                    </h5>
                                    <span class="connection-status connected">
                                        <i class="bi bi-check-circle me-1"></i>Êé•Á∂ö‰∏≠
                                    </span>
                                </div>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">SMTP„Çµ„Éº„Éê„Éº</label>
                                        <input type="text" class="form-control" value="smtp.example.com">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">„Éù„Éº„Éà</label>
                                        <input type="number" class="form-control" value="587">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">„É¶„Éº„Ç∂„ÉºÂêç</label>
                                        <input type="text" class="form-control" value="notifications@example.com">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">„Éë„Çπ„ÉØ„Éº„Éâ</label>
                                        <input type="password" class="form-control" value="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                    </div>
                                    <div class="col-12">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" checked>
                                            <label class="form-check-label">TLS/SSLÊöóÂè∑Âåñ„Çí‰ΩøÁî®</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-outline-primary btn-sm me-2">Êé•Á∂ö„ÉÜ„Çπ„Éà</button>
                                    <button class="btn btn-outline-secondary btn-sm">Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà</button>
                                </div>
                            </div>

                            <!-- SlackË®≠ÂÆö -->
                            <div class="delivery-config-card slack">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="mb-0">
                                        <i class="bi bi-slack me-2"></i>SlackÈÖç‰ø°Ë®≠ÂÆö
                                    </h5>
                                    <span class="connection-status connected">
                                        <i class="bi bi-check-circle me-1"></i>Êé•Á∂ö‰∏≠
                                    </span>
                                </div>
                                <div class="row g-3">
                                    <div class="col-12">
                                        <label class="form-label">Webhook URL</label>
                                        <input type="url" class="form-control" value="https://hooks.slack.com/services/...">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">„Éá„Éï„Ç©„É´„Éà„ÉÅ„É£„É≥„Éç„É´</label>
                                        <input type="text" class="form-control" value="#general" placeholder="#channel">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">„Éú„ÉÉ„ÉàÂêç</label>
                                        <input type="text" class="form-control" value="SES Bot">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-outline-primary btn-sm me-2">Êé•Á∂ö„ÉÜ„Çπ„Éà</button>
                                    <button class="btn btn-outline-secondary btn-sm">Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà</button>
                                </div>
                            </div>

                            <!-- PushÈÄöÁü•Ë®≠ÂÆö -->
                            <div class="delivery-config-card push">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="mb-0">
                                        <i class="bi bi-phone me-2"></i>PushÈÄöÁü•Ë®≠ÂÆö
                                    </h5>
                                    <span class="connection-status disconnected">
                                        <i class="bi bi-x-circle me-1"></i>Êú™Ë®≠ÂÆö
                                    </span>
                                </div>
                                <div class="row g-3">
                                    <div class="col-12">
                                        <label class="form-label">Firebase Server Key</label>
                                        <input type="password" class="form-control" placeholder="Firebase Server Key„ÇíÂÖ•Âäõ">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Firebase Sender ID</label>
                                        <input type="text" class="form-control" placeholder="Sender ID„ÇíÂÖ•Âäõ">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-outline-primary btn-sm me-2">Êé•Á∂ö„ÉÜ„Çπ„Éà</button>
                                    <button class="btn btn-outline-secondary btn-sm">Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà</button>
                                </div>
                            </div>
                        </div>

                        <!-- ÈÄöÁü•„É´„Éº„É´„Çø„Éñ -->
                        <div x-show="activeTab === 'rules'">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h4>ÈÄöÁü•„É´„Éº„É´</h4>
                                <button class="btn btn-success" @click="createNewRule()">
                                    <i class="bi bi-plus-circle me-1"></i>Êñ∞Ë¶è„É´„Éº„É´
                                </button>
                            </div>

                            <template x-for="rule in notificationRules" :key="rule.id">
                                <div class="rule-item" :class="{ 'active': rule.isActive, 'inactive': !rule.isActive }">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h6 x-text="rule.name"></h6>
                                            <p class="text-muted mb-0" x-text="rule.description"></p>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <div class="form-check form-switch me-3">
                                                <input class="form-check-input" type="checkbox" x-model="rule.isActive">
                                            </div>
                                            <button class="btn btn-outline-primary btn-sm me-2" @click="editRule(rule)">
                                                <i class="bi bi-pencil"></i>
                                            </button>
                                            <button class="btn btn-outline-danger btn-sm" @click="deleteRule(rule)">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="row g-3">
                                        <div class="col-md-4">
                                            <small class="text-muted">„Éà„É™„Ç¨„Éº</small>
                                            <div x-text="rule.trigger"></div>
                                        </div>
                                        <div class="col-md-4">
                                            <small class="text-muted">Êù°‰ª∂</small>
                                            <div x-text="rule.condition"></div>
                                        </div>
                                        <div class="col-md-4">
                                            <small class="text-muted">„Ç¢„ÇØ„Ç∑„Éß„É≥</small>
                                            <div x-text="rule.action"></div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>

                        <!-- „É¶„Éº„Ç∂„ÉºË®≠ÂÆö„Çø„Éñ -->
                        <div x-show="activeTab === 'preferences'">
                            <h4 class="mb-4">„É¶„Éº„Ç∂„ÉºÈÄöÁü•Ë®≠ÂÆö</h4>
                            
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">ÈÄöÁü•Á®ÆÂà•Ë®≠ÂÆö</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈñ¢ÈÄ£</h6>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked>
                                                <label class="form-check-label">„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈñãÂßã</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked>
                                                <label class="form-check-label">„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÆå‰∫Ü</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox">
                                                <label class="form-check-label">„Çπ„ÉÜ„Éº„Çø„ÇπÂ§âÊõ¥</label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Â•ëÁ¥ÑÈñ¢ÈÄ£</h6>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked>
                                                <label class="form-check-label">Â•ëÁ¥ÑÁ∑†Áµê</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked>
                                                <label class="form-check-label">Â•ëÁ¥ÑÊõ¥Êñ∞</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox">
                                                <label class="form-check-label">Â•ëÁ¥ÑÁµÇ‰∫Ü</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- „Ç∑„Çπ„ÉÜ„É†Ë®≠ÂÆö„Çø„Éñ -->
                        <div x-show="activeTab === 'system'">
                            <h4 class="mb-4">„Ç∑„Çπ„ÉÜ„É†Ë®≠ÂÆö</h4>
                            
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6 class="card-title">ÈÖç‰ø°Âà∂Èôê</h6>
                                            <div class="mb-3">
                                                <label class="form-label">1ÊôÇÈñì„ÅÇ„Åü„Çä„ÅÆÊúÄÂ§ßÈÄÅ‰ø°Êï∞</label>
                                                <input type="number" class="form-control" value="1000">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">ÂÜçË©¶Ë°åÂõûÊï∞</label>
                                                <input type="number" class="form-control" value="3">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">ÂÜçË©¶Ë°åÈñìÈöîÔºàÂàÜÔºâ</label>
                                                <input type="number" class="form-control" value="5">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6 class="card-title">„É≠„Ç∞Ë®≠ÂÆö</h6>
                                            <div class="mb-3">
                                                <label class="form-label">„É≠„Ç∞„É¨„Éô„É´</label>
                                                <select class="form-select">
                                                    <option value="DEBUG">DEBUG</option>
                                                    <option value="INFO" selected>INFO</option>
                                                    <option value="WARN">WARN</option>
                                                    <option value="ERROR">ERROR</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">„É≠„Ç∞‰øùÊåÅÊúüÈñìÔºàÊó•Ôºâ</label>
                                                <input type="number" class="form-control" value="30">
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked>
                                                <label class="form-check-label">Ë©≥Á¥∞„É≠„Ç∞Âá∫Âäõ</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Alpine.js -->
    <script src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js" defer></script>

    <script>
        function notificationSettings() {
            return {
                activeTab: 'templates',
                selectedTemplate: null,
                previewValues: {},
                
                templates: [
                    {
                        id: 1,
                        name: '„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂèÇÂä†ÈÄöÁü•',
                        type: 'EMAIL',
                        category: 'project',
                        description: 'ÊäÄË°ìËÄÖ„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂèÇÂä†ÊôÇ„Å´ÈÄÅ‰ø°',
                        version: 2,
                        isActive: true,
                        usageCount: 127,
                        subject: '„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂèÇÂä†„ÅÆ„ÅäÁü•„Çâ„Åõ - {{projectName}}',
                        bodyTemplate: `{{userName}} Êßò

„ÅäÁñ≤„ÇåÊßò„Åß„Åô„ÄÇ

Êñ∞„Åó„ÅÑ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Äå{{projectName}}„Äç„Å´ÂèÇÂä†„Åô„Çã„Åì„Å®„ÅåÊ±∫ÂÆö„Åó„Åæ„Åó„Åü„ÅÆ„Åß„ÅäÁü•„Çâ„Åõ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ

‚ñ† „Éó„É≠„Ç∏„Çß„ÇØ„ÉàË©≥Á¥∞
„ÉªÈñãÂßãÊó•: {{startDate}}
„ÉªÁµÇ‰∫Ü‰∫àÂÆöÊó•: {{endDate}}
„ÉªÊãÖÂΩì„É≠„Éº„É´: {{role}}

„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„ÅÑ„Åü„Åó„Åæ„Åô„ÄÇ`,
                        variables: [
                            { name: 'userName', type: 'string', required: true },
                            { name: 'projectName', type: 'string', required: true },
                            { name: 'startDate', type: 'date', required: true },
                            { name: 'endDate', type: 'date', required: false },
                            { name: 'role', type: 'string', required: true }
                        ]
                    },
                    {
                        id: 2,
                        name: '„Ç∑„Çπ„ÉÜ„É†„É°„É≥„ÉÜ„Éä„É≥„ÇπÈÄöÁü•',
                        type: 'SLACK',
                        category: 'system',
                        description: '„É°„É≥„ÉÜ„Éä„É≥„ÇπÊÉÖÂ†±„Çí„ÉÅ„Éº„É†„Å´ÈÄöÁü•',
                        version: 1,
                        isActive: true,
                        usageCount: 45,
                        subject: null,
                        bodyTemplate: `üîß „Ç∑„Çπ„ÉÜ„É†„É°„É≥„ÉÜ„Éä„É≥„ÇπÈÄöÁü•

„É°„É≥„ÉÜ„Éä„É≥„ÇπÊó•ÊôÇ: {{maintenanceDate}}
‰∫àÂÆöÊôÇÈñì: {{duration}}
ÂØæË±°„Ç∑„Çπ„ÉÜ„É†: {{targetSystem}}

Ë©≥Á¥∞: {{details}}`,
                        variables: [
                            { name: 'maintenanceDate', type: 'datetime', required: true },
                            { name: 'duration', type: 'string', required: true },
                            { name: 'targetSystem', type: 'string', required: true },
                            { name: 'details', type: 'string', required: false }
                        ]
                    }
                ],

                notificationRules: [
                    {
                        id: 1,
                        name: '„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈñãÂßãËá™ÂãïÈÄöÁü•',
                        description: '„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çπ„ÉÜ„Éº„Çø„Çπ„ÅåÈñãÂßã„Å´Â§âÊõ¥„Åï„Çå„ÅüÊôÇ„Å´Èñ¢‰øÇËÄÖ„Å´ÈÄöÁü•',
                        trigger: '„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Çπ„ÉÜ„Éº„Çø„ÇπÂ§âÊõ¥',
                        condition: '„Çπ„ÉÜ„Éº„Çø„Çπ = ÈñãÂßã',
                        action: '„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂèÇÂä†ÈÄöÁü•„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅßÈÄÅ‰ø°',
                        isActive: true
                    },
                    {
                        id: 2,
                        name: 'Â•ëÁ¥ÑÊúüÈôê„Ç¢„É©„Éº„Éà',
                        description: 'Â•ëÁ¥ÑÁµÇ‰∫Ü30Êó•Ââç„Å´ÊãÖÂΩìËÄÖ„Å´ÈÄöÁü•',
                        trigger: '„Çπ„Ç±„Ç∏„É•„Éº„É´',
                        condition: 'Â•ëÁ¥ÑÁµÇ‰∫ÜÊó•-30Êó•',
                        action: 'Â•ëÁ¥ÑÊõ¥Êñ∞„É™„Éû„Ç§„É≥„ÉÄ„ÉºÈÄÅ‰ø°',
                        isActive: true
                    },
                    {
                        id: 3,
                        name: 'Âã§ÊÄ†Êú™ÊâøË™ç„Ç¢„É©„Éº„Éà',
                        description: 'ÊúàÊú´Êú™ÊâøË™ç„ÅÆÂã§ÊÄ†„Åå„ÅÇ„ÇãÂ†¥Âêà„Å´„Éû„Éç„Éº„Ç∏„É£„Éº„Å´ÈÄöÁü•',
                        trigger: '„Çπ„Ç±„Ç∏„É•„Éº„É´',
                        condition: 'ÊúàÊú´ & Êú™ÊâøË™çÂã§ÊÄ†„ÅÇ„Çä',
                        action: 'Âã§ÊÄ†ÊâøË™ç‰æùÈ†ºÈÄöÁü•ÈÄÅ‰ø°',
                        isActive: false
                    }
                ],

                availableVariables: ['userName', 'projectName', 'startDate', 'endDate', 'role', 'companyName'],

                selectTemplate(template) {
                    this.selectedTemplate = { ...template };
                    this.previewValues = {};
                    // Â§âÊï∞„ÅÆ„Éá„Éï„Ç©„É´„ÉàÂÄ§„ÇíË®≠ÂÆö
                    template.variables.forEach(variable => {
                        this.previewValues[variable.name] = this.getDefaultValue(variable.type);
                    });
                },

                getDefaultValue(type) {
                    switch (type) {
                        case 'string': return '„Çµ„É≥„Éó„É´„ÉÜ„Ç≠„Çπ„Éà';
                        case 'date': return '2024-01-20';
                        case 'datetime': return '2024-01-20 10:00';
                        default: return '„Çµ„É≥„Éó„É´ÂÄ§';
                    }
                },

                getTemplatePreview() {
                    if (!this.selectedTemplate) return '';
                    
                    let preview = this.selectedTemplate.bodyTemplate;
                    Object.entries(this.previewValues).forEach(([key, value]) => {
                        const regex = new RegExp(`{{${key}}}`, 'g');
                        preview = preview.replace(regex, value);
                    });
                    return preview;
                },

                insertVariable(variable) {
                    // „ÉÜ„Ç≠„Çπ„Éà„Ç®„É™„Ç¢„Å´Â§âÊï∞„ÇíÊåøÂÖ•„Åô„ÇãÂá¶ÁêÜ
                    alert(`Â§âÊï∞ {{${variable}}} „Çí„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å´ÊåøÂÖ•„Åó„Åæ„Åô`);
                },

                addVariable() {
                    const name = prompt('Â§âÊï∞Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:');
                    if (name && this.selectedTemplate) {
                        this.selectedTemplate.variables.push({
                            name: name,
                            type: 'string',
                            required: false
                        });
                        this.previewValues[name] = '„Çµ„É≥„Éó„É´ÂÄ§';
                    }
                },

                removeVariable(variableName) {
                    if (this.selectedTemplate) {
                        this.selectedTemplate.variables = this.selectedTemplate.variables.filter(
                            v => v.name !== variableName
                        );
                        delete this.previewValues[variableName];
                    }
                },

                createNewTemplate() {
                    const newTemplate = {
                        id: Date.now(),
                        name: 'Êñ∞Ë¶è„ÉÜ„É≥„Éó„É¨„Éº„Éà',
                        type: 'EMAIL',
                        category: 'system',
                        description: '',
                        version: 1,
                        isActive: false,
                        usageCount: 0,
                        subject: '',
                        bodyTemplate: '',
                        variables: []
                    };
                    this.templates.push(newTemplate);
                    this.selectTemplate(newTemplate);
                },

                saveTemplate() {
                    alert('„ÉÜ„É≥„Éó„É¨„Éº„Éà„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü');
                },

                deleteTemplate() {
                    if (confirm('„Åì„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                        this.templates = this.templates.filter(t => t.id !== this.selectedTemplate.id);
                        this.selectedTemplate = null;
                    }
                },

                previewTemplate() {
                    alert('„Éó„É¨„Éì„É•„ÉºÊ©üËÉΩÔºàÂÆüË£Ö‰∫àÂÆöÔºâ');
                },

                createNewRule() {
                    alert('Êñ∞Ë¶è„É´„Éº„É´‰ΩúÊàêÊ©üËÉΩÔºàÂÆüË£Ö‰∫àÂÆöÔºâ');
                },

                editRule(rule) {
                    alert(`„É´„Éº„É´ "${rule.name}" „ÇíÁ∑®ÈõÜÔºàÂÆüË£Ö‰∫àÂÆöÔºâ`);
                },

                deleteRule(rule) {
                    if (confirm('„Åì„ÅÆ„É´„Éº„É´„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                        this.notificationRules = this.notificationRules.filter(r => r.id !== rule.id);
                    }
                },

                saveAllSettings() {
                    alert('Ë®≠ÂÆö„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü');
                }
            }
        }
    </script>
</body>
</html>